# aws-solution-architecture-professional-note

## Cost Management 
- Compute Optimizer creates a dashboard shows you savings and performance improvement opportunities at the account level.
  - Only works with EC2, Lambda and EBS
  - Default infrastructure metric: recommendation with metric from **14** days period
  - Enhanced infrastructure metric: recommendation with metric from **90** days period
- You can config AWS Budgets with an alert threshold, a budget action to apply
  - Notification via ChatBot, SNS or Email
  - apply a SCP for OUs or AWS accounts(only management account)
  - action targeting specific EC2 or RDS
 
## Global Infrastructure
- Global Accelerator can only be placed in front of Load Balancers, not CloudFront Distribuitions.
  - Global Accelerator provides two global static public IPs that act as a fixed entry point to your application endpoints, such as Application Load Balancers, Network Load Balancers, Amazon Elastic Compute Cloud (EC2) instances, and elastic IPs.

 ## Disater Recovery
 - Elastic Disater Recovery create a minimal copy of your currenty application(on-premise or cloud) with the AWS Resources(EC2, EBS), then continously replicate data with the production. During normal operation, maintain readiness by monitoring replication and periodically performing non-disruptive recovery and failback drills.

## Migration
- AWS Migration Hub is single place to discover existing server, plan migration and track the status of the migration proccess
  - Migration statergy can be rehost, replatform and refactor of the applications.
  - You can import information about on-premises servers and applications, or you can perform a deeper discovery using AWS Discovery Agent or AWS Discovery Collector, an agentless approach for VMware environments.
- Migration strategy
![migration strategy](https://github.com/user-attachments/assets/9d621ef4-aa9f-4b96-b85d-ab864eee9c76)
- Discovery Agent can not send log to S3, only to Application Discovery Service. In Migration Hub, enable Data Exploration to query data in Athena.
- Application Discovery Service Agentless Collector for VMWare is a virtual machine, which is provided via an OVA file. It needs a IAM user credentials to authenticate with AWS to forward to the Application Discovery Service.
- In DMS, the mapping rules(JSON) should be put in source endpoint config
- Setting up cross-account access in Migration Hub to cosolidate discovery data from multiple AWS accounts into a single pane of glass.
- AWS Application Migration Service reuqire
  - Communication over TCP port 443
    - source servers <-> MGN region endpoint
    - staging area subnet <-> MGN region endpoint
  - Communication over TCP port 1500 between source servers <-> staging area subnet
    - Each source server with an installed AWS Replication Agent continuously communicates with the AWS Application Migration Service replication servers in the staging area subnet over TCP port 1500

## Network
- NAT Gateway is only for IPv4. With IPv6, if you want to connect to internet from a private subnet, a egress-only internet gateway should be used.
  - There is no charge for an egress-only internet gateway, but there are data transfer charges for EC2 instances that use internet gateways
- Transit Gateway allow enabling multicast and select subnets to include in the multicast domain when associating VPC attachments.
- Route53 Resolver
  - Inbound endpoints allow DNS queries to your VPC from on-premise network or another VPC
  - Outbound endpoints allow DNS queries from your VPC to on-premise network or another VPC
  - Resolver rules enable you to create one forwarding rule for each domain name and specify the name of the domain for which you want to forward DNS queries from your VPC to an on-premises DNS resolver and from your on-premises to your VPC. Rules are applied directly to your VPC and can be shared across multiple accounts.
  - Should be created with specific availablibity zone.
- To create AWS Site-to-Site VPN
  - Create a customer gateway: Need a Border Gateway Protocol(BGP) Autonomous System Number(ASN) if the routing type is dynamic; a static internet-routable IP address for the customer gateway device
  - Create a target gateway(on the AWS side of connection), can be a virtual private gateway or transit gateway
  - Config routing: configure your route table to include the routes used by your VPN connection and point them to your virtual private gateway or transit gateway.
  - Update your security group
  - Create a VPN connection: Create the VPN connection using the customer gateway in combination with the virtual private gateway or transit gateway that you created earlier.
  - Download the configuration file: After you create the VPN connection, you can download a sample configuration file to use for configuring the customer gateway device.
  - Configure the customer gateway device: Use the sample configuration file to configure your customer gateway device. The customer gateway device is the physical or software appliance on your side of the VPN connection
- Direct Connect can be setup redundantly by creating 2nd connection to a different Direct Connection location to improve availability. 
- 2 VPN connections from different Customer Gatewayto single Virtual Private Gateway with dynamic routing in BGP + VPN Equal-Cost Multi-Path routing can be implemented to increase availability. 

## IoT
- AWS IoT Core helps you connect devices to AWS Services and other devices, secure data interactions, and process and act upon device data.
  - AWS IoT Core provides a fully managed palette of MQTT-based messaging features
- AWS IoT SiteWise is a managed service that makes it easy to collect, organize, and analyze data from industrial equipment at scale.
  - Data collection using SiteWise:
    - AWS IoT SiteWise Edge, on-premises software used to collect, organize, process, and monitor equipment data locally before sending it to AWS.
    - MQ Telemetry Transport (MQTT) protocol integration using AWS IoT Core.
- IoT Analytics is a tool to run and operate analytics on massive volumes of IoT data.
  - It is suitable for analyzing data at rest(S3 or Kinesis Data Streams or directly from IoT Core). Can be used with SQL queries and intergrated with QuickSight 
  - For using IoT Analytics a channel is defined that filters data to be stored and analyzed. The processed data can be stored in time series data storage for futher queries.
- Kinesis Analytics is a suitable service for analyzing streaming data
- IoT 1-click helps to launch AWS Lambda functions from the ready-to-use simple IoT devices. I can also be used to manage these devices from mobile apps or from the console
- IoT Events is a service used to detect and respond to events from IoT sensors. It montors sensors for operational changes and initiates actions to alert users.
  - You can complete an event detector setup in AWS IoT Events, write your event logic using simple ‘if-then-else’ statements, and select the alert or custom action to trigger when the event occurs. 
- AWS IoT TwinMaker is a service that makes it faster and easier to create digital twins of real-world systems and apply them to improve operations. For creating digital twins, following steps needs to take
  - Collect Data from multiple IoT sensors(using AWS IoT SiteWise)
  - Using IoT TwinMaker to create a digital twin from the collected data
    - Create a workspace
    - Associate with the datastore (IoT SiteWise)
      - AWS IoT TwinMaker provides built-in connectors for different data stores, including AWS IoT SiteWise for time-series sensor data, Amazon Kinesis Video Streams for video data, and Amazon Simple Storage Service (S3) for document data. 
    - Using the AWS IoT TwinMaker console-based scene composer, import 3D models (such as CAD files and point cloud scans) to compose scenes, and position the 3D assets to correctly match and represent your physical environment and systems. 
    - Create a web-based digital twin application using the AWS IoT TwinMaker plug-in for Amazon Managed Grafana which build dashboards embedding 3D scences and display data insights about the physical systems
- IoT Device Defender is a tool to audit configs, authenticate devices, detect anomaly and receive alerts to secure IoT device fleet
- IoT Device Management helps register, organize, monitor, and remotely manage IoT devices at scale. Integrate with IoT core to easily connect and manage device.
  - Bulk register, organize group, update over the air
  - Create a device tunnel - secure remote SSH session to a device installed behind a restricted firewall
  - Define jobs or actions, then run it on selected group of devices
- AWS IoT rules allow devices to interact with AWS services. Rules are analyzed and actions are performed based on MQTT topic streams
  - Augment or filter data received from a device
  - Write data received from a device to DynamoDB
  - Save a file to S3
  - Send notification using SNS
  - Publish data to SQS
- AWS IoT Greengrass is software that lets customers run local compute, messaging, data caching, sync, and ML inference capabilities for connected devices, allowing connected devices to operate even with intermittent connectivity to the cloud. After the device reconnects, AWS IoT Greengrass synchronizes the data on the device with AWS IoT Core, providing constant functionality regardless of connectivity. AWS IoT Greengrass seamlessly extends AWS to devices so they can act locally on the data they generate, while still using the cloud for management, analytics, and durable storage.
  
## Machine Learning
- To import time-series data into Amazon Forecast, the time-series data must be stored in S3
- How to use Fraud Detector
  - Build, train, and deploy an Amazon Fraud Detector model based on historical events
  - Generate fraud predictions
    - Build detector
    - Add model
    - Add rules
    - Configure rule execution and rule order
    - Review and create detector version -> activate
- Amazon Comprehend(Natural-language Processing- NLP) is used to extract insight from documents. For ex, it can detect how customers feel about products

## Security
- Amazon Detective has role session analysis feature that can provide visibility to role usage, cross-account role assumptions, role-chaining activitiese performed across multiple accounts.
- AWS Network Firewall can be used to inspect and control traffice between VPCs or subnets in the same VPC using VPC routing enhancements. 
- AWS Config best practice
  - Enable AWS Config in all accounts and Regions.
  - Record configuration changes to ALL resource types.
  - Record global resources (such as IAM resources) only in one Region.
  - Ensure that you have a secure Amazon S3 bucket to collect the configuration history and snapshot files.
  - Specify an Amazon S3 bucket from another (central IT) account for centralized management of history files and snapshots.
  - Specify an Amazon Simple Notification Service (Amazon SNS) topic from another (central IT) account for centralized management of configuration and compliance notifications.
  - Use Amazon CloudWatch Events to filter AWS Config notifications and take action.
  - Set the appropriate permissions for the IAM role assigned to AWS Config.
    - Use the AWS Config service linked role to allow Config to record resource configuration changes.
    - If you prefer to create an IAM role for AWS Config yourself, use the AWS managed policy AWS_ConfigRole and attach it to your IAM role.
  - Ensure that the SNS topic permissions are restricted to only allow AWS Config to publish messages to it.
  - Turn on periodic snapshots with a minimum frequency of once per day.
  - Use the AWS CloudTrail Lookup API action to find the API events that occurred in the timeframe when the configuration change occurred.
  - If you have your own third party ITSM or CMDB solution like ServiceNow or Jira Service desk, use the AWS Service Management connector to feed Config data into those systems.
  - Identify resources that are undergoing the most configuration changes on a routine basis to control costs.
  - Use Conformance Packs in your account as well as across your organization.
  - Leverage the sample templates for conformance packs as a starting point to quickly bootstrap your accounts.
  - Use AWS Security Hub for an opinionated set of security checks and AWS Config conformance packs for any customization or building your own compliance pack.
  - Use the AWS Config Rule Development Kit (RDK) for authoring custom rules.
  - Create change-triggered custom rules for resource types supported in AWS Config.
  - Create periodic custom rules for resource types not supported in AWS Config.
  - In a multi-account scenario involving custom rules, centralize the Lambda function in one account for easier management.
  - Use the AWS Config Rules repository, a community-based source of custom AWS Config rules.
  - Config rules and conformance packs that have global resources in scope (such as IAM), should only be deployed in one region to avoid costs and API throttling.
  - For custom rules, while submitting put-evaluations, use “annotations” to add supplementary information about how the evaluation determined the compliance.
  - Ensure judicious usage of “DeleteResults” and “Re-evaluate”rules functionalities for your config rules to avoid spike in AWS Config billing.
  - Use the data aggregation feature to aggregate resource configuration and compliance data into a central account.
  - Create an organizations-based aggregator to aggregate AWS Config data from your entire organization.
  - Use the Advanced queries feature to centrally query your resource configuration and compliance data.
  - Use Amazon Athena to query the historical state of your resources.
- IAM -> Organization activity can check last activities on all services in the organization
- AWS Firewall Manager pre-quisites
  - Account must be part of AWS Organization and have enabled all features
  - Firewall Manager must be associate with the management account or associate with a member account that has the appropiate permission
  - AWS Config for each member account
  - (Optional) Enable RAM to centrally config Network Firewall or associate Route53 Resolver DNS Firewall rules across accounts and VPCs
- Using AD Connector in the AWS Directory Service as a directory gateway to forward directory requests. Connect IAM Identity Center to the self-managed AD by using the AD Connector.
  - Trust relationship between AWS Managed Microsoft AD and the self-managed AD should be two-way and can not be one-way.
- AWS Identity and Access Management (IAM) Access Analyzer helps to identify resources in your organization and accounts, such as S3 buckets or IAM roles, that are shared with an external entity.
- You can only attach permission boundary only to a user or role, not a group
- SCPs are not available in an organization in which only consolidated billing is enabled. For SCPs to be available, you must enable all features in the organization.
- 

## Database
- Timestream is a serverless time series database which can be use to store and analyze events.
  - Compare to traditional relational databases, it cost less.
  - Has no limit in storage
  - 2 tiers of storage: memory store and magnetic store.
  - Based on retention policies, data can be moved from memory store to magnetic store for optimize cost
  - Scheduled query can be used for reports, or for alarms that detect anomalies
  - Timestream offers a choice of two databases: Amazon Timestream for LiveAnalytics and Amazon Timestream for InfluxDB.
- In Amazon DocumentDB, storage scales automatically up to 128 TiB in Instance-based Clusters, and 4 PiB in Amazon DocumentDB Elastic Clusters
- Athena Federated Query uses AWS Lambda functions to access and query data from external databases, such as RDS, Redshift or other datasources. The Lambda function acts as a bridge between Athena and the external databases, allowing Athena to execute queries against data that resides outside of S3.

## Cognito
- To enable guest access with Cognito, enable unauthenticated access in Cognito Identity Pool. Then guest users can request an identity ID via GetId API
- Cognito
  - User pool are for authentication(identity verification)
  - Identity pool are for authorization(access control)
- Amazon Cognito has two different flows for authentication with public providers: enhanced and basic.
  - Enhanced (simplified) authflow
    - Your application presents a proof of authentication–a JSON web token or a SAML assertion–from an authorized Amazon Cognito user pool or third-party identity provider in a GetID request.
    - Your identity pool returns an identity ID.
    - Your application combines the identity ID with the same proof of authentication in a `GetCredentialsForIdentity` request.
    - Your identity pool returns AWS credentials.
    - Your application signs AWS API requests with the temporary credentials.
  - Basic (classic) authflow
    - Your application presents a proof of authentication–a JSON web token or a SAML assertion–from an authorized Amazon Cognito user pool or third-party identity provider in a GetID request.
    - Your identity pool returns an identity ID.
    - Your application combines the identity ID with the same proof of authentication in a `GetOpenIdToken` request.
    - GetOpenIdToken returns a new OAuth 2.0 token that is issued by your identity pool.
    - Your application presents the new token in an AssumeRoleWithWebIdentity request.
    - AWS Security Token Service AWS STS returns AWS credentials.
    - Your application signs AWS API requests with the temporary credentials.
- When a custom domain is added to Cognito user pool, a CloudFront distribuition is created with and ACM. This CloudFront distribuition is owned by Cognito and not by the individual account
- In addition to the access token returned by IdP, a Cognito Identity ID is also returned to provide a set of temporary, limited-privilege AWS credentials. If you're allowing unauthenticated users, you can retrive a unique identity ID immediately. If you're authenticating users, you can retrive the identity ID after setting the login tokens in the credentials provider.

## API Gateway
- API Gateway supported response types: https://docs.aws.amazon.com/apigateway/latest/developerguide/supported-gateway-response-types.html
  - When client attemps to invoke unsupported API method or resources, API Gateway will return 403 MISSING_AUTHENTICATION_TOKEN, not 404 by default
- In API Gateway, response can be cached reduce load to backend
- For Lambda integration
  - Proxy Integration: API Gateway passes the raw request to the integrated Lambda function as it is
  - Custom Integration: mapping of the query string parameter for the Lambda function is provided via the user property of the JSON payload.
- API Gateway supports multiple mechanisms for controlling and managing access to your API.You can use the following mechanisms for authentication and authorization:
  - Resource policies let you create resource-based policies to allow or deny access to your APIs and methods from specified source IP addresses or VPC endpoints. For more information, see Control access to a REST API with API Gateway resource policies.
  - Standard AWS IAM roles and policies offer flexible and robust access controls that can be applied to an entire API or individual methods. IAM roles and policies can be used for controlling who can create and manage your APIs, as well as who can invoke them. For more information, see Control access to a REST API with IAM permissions.
  - IAM tags can be used together with IAM policies to control access. For more information, see Using tags to control access to API Gateway REST API resources.
  - Endpoint policies for interface VPC endpoints allow you to attach IAM resource policies to interface VPC endpoints to improve the security of your private APIs. For more information, see Use VPC endpoint policies for private APIs in API Gateway.
  - Lambda authorizers are Lambda functions that control access to REST API methods using bearer token authentication—as well as information described by headers, paths, query strings, stage variables, or context variables request parameters. Lambda authorizers are used to control who can invoke REST API methods. For more information, see Use API Gateway Lambda authorizers.
  - Amazon Cognito user pools let you create customizable authentication and authorization solutions for your REST APIs. Amazon Cognito user pools are used to control who can invoke REST API methods. For more information, see Control access to REST APIs using Amazon Cognito user pools as an authorizer.

## Others
- Default retetion period of Kinesis DataStream is 24 hours, can be extended up to 365 days.
- There are 2 ways to share database in Data Lake to other accounts
  - Lake Formation Tag-based access control: define perssimsion using attributes, to share Data Catalog resource to external IAM principals, AWS accounts, Organizations and organizational units (OUs)(recommended)
  - Lake Formation named resources: allows you to grant Lake Formation permissions with a grant option on Data Catalog tables and databases to external AWS accounts, IAM principals, organizations, or organizational units. The grant operation automatically shares those resources.
- To run queries against database on other accounts using integrated service such as Athena or Redshift Spectrum, a resource links is required.
- AWS Service Catalog
  - Template constrain: Restrict the configuration parameters that are available for the user when launching the product (for example, EC2 instance types or IP ranges).
  - Launch constraints: Allow you to specify a role for a product in a portfolio. This role is used to provision the resources at launch, so you can restrict user permissions without impacting users’ ability to provision products from the catalog (for example, for marketing users, you can enable them to create campaign websites, but use constraints to restrict their access to provision the underlying databases)
  - Using service actions, you can enable end users to perform operational tasks, troubleshoot issues, run approved commands, or request permissions in AWS Service Catalog on your provisioned products, without needing to grant end users full access to AWS services. You use AWS Systems Manager documents to define service actions.
- AWS Proton is an infrastructure provisioning and deployment service for serverless and container-based applications across multiple accounts. The platform team can use environment templates to create the environment which includes infrastructure service such as VPC, subnets, route tables, etc. With Proton the IAM service role is supplied along with the templates which consist of the permission required to provision resources
  - Infrastructure can be provisioned in one of serveral ways: AWS managed(using CloudFormation), CodeBuild(using CLI, AWS CDK), or self-managed(terraform) 
- Elastic Beanstalk managed update require Update level(Minor and patch or patch only) and Weekly update window to perfome the update. During the update process, the application stay available.
- Kinesis Data Firehose destination: S3, Redshift, OpenSearch, HTTP Endpoint(Datadog, New Relic, Splunk, etc), MongoDB
  - With Redshift destination, first Firehose deliver data to intermediate S3 bucket, then load data into Redshift cluster using COPY command. All data will not be deleted after loading
- Output of Kinesis Rekognition should be stored in Kinesis datastream. 
- AWS Transcribe is an automatic speech recognition service that use machine learning models to convert audio to text. Polly is the opposite way(text to speech)
- CloudFormation StackSets can be deploy with either `self-managed` or `service-managed` permissions.
  - self-managed: you can deploy stack instances to specific AWS accounts in specific Regions. To do this, you must first create the necessary IAM roles to establish a trusted relationship between the account you're administering the stack set from and the account you're deploying stack instances to.
  - service-managed: you can deploy stack instances to accounts managed by AWS Organizations in specific Regions. With this model, you don't need to create the necessary IAM roles; StackSets creates the IAM roles on your behalf. You can also enable automatic deployments to accounts that are added to a target organization or organizational unit (OU) in the future. With automatic deployments enabled, StackSets automatically deletes stack instances from an account if it's removed from a target organization or OU.
- AWS Local Zones vs Wavelength Zones vs Outpost
  - Local Zones is and extent of AWS Region to bring some AWS Services(EC2, EBS, Shield, ELB, ECS, EKS, VPC, Direct Connect, FSx) closer to end-users to reduce latency.
  - Wavelength Zones deploys some standard AWS Services(EC2(some instance types are supported), EBS(gp2 only, max 30TB) ECS, EKS, CloudWatch, CloudTrail, CloudFormation, ALB) at the edge of communications service providers' networks. Resources inside wavelength zone connect to outsite via carrier gateway(act like NAT gateway). You can not assign IPv6 address to subnets that are in Wavelength Zones
  - Outpost: AWS Service at on-premise location
- EC2 instances that are in two different Wavelength Zones in the same VPC are not allowed to communicate with each other. If you need communication from one Wavelength Zone to another Wavelength Zone, we recommends that you use multiple VPCs, one for each Wavelength Zone. You can use a transit gateway to connect the VPCs. This configuration enables communication between instances in the Wavelength Zones. 
- Step Functions supports 3 type of workflows
  - Standard Workflows(exactly-once) are ideal for long-running (up to one year), durable, and auditable workflows. You can retrieve the full execution history using the Step Functions API for up to 90 days after your execution completes. Standard Workflows follow an exactly-once model, where your tasks and states are never run more than once, unless you have specified Retry behavior in ASL. This makes Standard Workflows suited to orchestrating non-idempotent actions, such as starting an Amazon EMR cluster or processing payments. Standard Workflow executions are billed according to the number of state transitions processed.
  - Asynchronous Express Workflows(At-least-once) return confirmation that the workflow was started, but don't wait for the workflow to complete. To get the result, you must poll the service's CloudWatch Logs. You can use Asynchronous Express Workflows when you don't require immediate response output, such as messaging services or data processing that other services don't depend on. You can start Asynchronous Express Workflows in response to an event, by a nested workflow in Step Functions, or by using the StartExecution API call.
  - Synchronous Express Workflows(At-most-once) start a workflow, wait until it completes, and then return the result. Synchronous Express Workflows can be used to orchestrate microservices. With Synchronous Express Workflows, you can develop applications without the need to develop additional code to handle errors, retries, or run parallel tasks. You can run Synchronous Express Workflows invoked from Amazon API Gateway, AWS Lambda, or by using the StartSyncExecution API call.
- S3 SSE-KMS encryption cost can be reduced by using bucket key
- 2 ways to play video stream from Kinesis Video Streams
  - GetHLSStreamingSessionURL: Using HLS(HTTP Live Streaming) format, can be used in a media player or mobile phone player
  - GetDASHStreamingSessionURL: Using MPEG Dynamic Streaming over HTTP, can be opend in the URL of the media player
- Lambda layer is a .zip file archive that contains supplementary code or data. Layers usually contain library dependencies, a custom runtime or configuration files.
- Lambda extensions can be used to integrate with monitoring, observability, security, governance tools
  - Extenal: runs as an independent process in the execution environment and continues to run after the function invocation is fully processed.
  - Internal: extension runs as part of the runtime process. Your function accesses internal extensions by using wrapper scripts or in-process mechanisms such as JAVA_TOOL_OPTIONS.
- The AWS-generated cost allocation tags must be activated via Billing and Cost Management console. This tag will only appear only in the Billing console, not anywhere else
- Storage Gateway provides three types of storage interfaces for your on-premises applications: file, volume, and tape.
  - The Amazon S3 File Gateway enables you to store and retrieve objects in Amazon Simple Storage Service (S3) using file protocols such as Network File System (NFS) and Server Message Block (SMB). Objects written through S3 File Gateway can be directly accessed in S3.
  - The Amazon FSx File Gateway enables you to store and retrieve files in Amazon FSx for Windows File Server using the SMB protocol. Files written through Amazon FSx File Gateway are directly accessible in Amazon FSx for Windows File Server.
  - The Volume Gateway provides block storage to your on-premises applications using iSCSI connectivity. Data on the volumes is stored in Amazon S3 and you can take point-in-time copies of volumes that are stored in AWS as Amazon EBS snapshots. You can also take copies of volumes and manage their retention using AWS Backup. You can restore EBS snapshots to a Volume Gateway volume or an EBS volume.
  - The Tape Gateway provides your backup application with an iSCSI virtual tape library (VTL) interface, consisting of a virtual media changer, virtual tape drives, and virtual tapes. Virtual tapes are stored in Amazon S3 and can be archived to Amazon S3 Glacier or Amazon S3 Glacier Deep Archive.
- To switch role between accounts, either switch directly from AWS console once you logged in or using the switch role page that came from email sent by the administrator. The link can be found found when the target role is created.
- In SQS the visibility time out can be set either via queue's default setting or individually for every message.
- You can use intrinsic functions only in specific parts of a CloudFormation template. Currently, you can use intrinsic functions in resource properties, outputs, metadata attributes, and update policy attributes. You can also use intrinsic functions to conditionally create stack resources.
- System Manager managed EC2 and non-EC2 instance via SSM Agent, and it free of charge on standard tier(up to 1000 instances).
- State Manager vs Maintenance Windows:
  - State Manager sets and maintains the targeted state configuration for managed nodes and AWS resources within your AWS account.You can define combinations of configurations and targets as association objects. State Manager is the recommended capability if you want to maintain all managed nodes in your account in a consistent state, use Amazon EC2 Auto Scaling to generate new nodes, or have strict compliance reporting requirements for the managed nodes in your account.
  - A maintenance window takes one or more actions on AWS resources within a given time window. You can define a single maintenance window with start and end times. You can specify multiple tasks to run within this maintenance window.
- To access S3 on Outposts buckets and objects, you must have
  - An access point for the VPC
  - And endpoint for the same VPC
  - An active connection between your Outposts and your AWS regions
  - Note: Because the AWS Management Console is hosted in-Region, you can't use the console to upload or manage objects in your Outpost. However, you can use the REST API, AWS Command Line Interface (AWS CLI), and AWS SDKs to upload and manage your objects through your access points.
- S3 on Outposts has 2 access type: Private(for VPC routing, with private endpoint, data will stay AWS Network) or CustomerOwnedIP(to work with both on-premise network and VPC, the data will travese over the public internet)
- To configure SSM Agent to send log data to CloudWatch Logs, edit the `/etc/amazon/ssm/seelog.xml.template`
- CloudWatch Canary blueprint can be used for follow scenarios
  - Heartbeat Monitor: load specified URL and store screenshot of the page and HTTP archive file. HAR can be used to view detailed performance data of the page. Only test if the target is reachable.
  - API Canary: REST API testing. Can be integrated with API Gateway. It will check the API if it's reachable and responsed as expected.
  - Broken Link Checker: collect all the links inside a URL for erros(404, invalide hostname, bad URL, etc)
  - Visual Monitoring: compare screenshots taken during canary run with the screenshot taken during a baseline canary run. If the discrepancy between the two screenshots is beyond a threshold percentage, the canary fails.
  - Canary Recorder: record your click and type actions on a website and automatically generate a Node.js script that can be used to create a canary that follows the same steps. The CloudWatch Synthetics Recorder is a Google Chrome extension provided by Amazon.
  - GUI Workflow: like Datadog E2E test
- In the event of failover in Aurora Global database, the endpoint of the secondary cluster will be changed(the `-ro` part will be remove as the cluster become a writer)
- Elastic Transcoder(2013) use pipeline + job. MediaConvert(2017) support more formats(H265), use queue + job and also cheaper. Both using S3 as source
- License Manager can automated tracking and enforcement rules dynamically to ensure license usage stay within allocated limits.
- To replicate data from Apache Kafka cluster to another one, you can use MirrorMaker, which is multi-cluster data replication engine based on Kafka Connect framework.
- Steps to create Hyperledger Farbic network using AWS Managed Blockchain
  - Create a new Fabric network
  - Create the first member of the network, including the administrative user and administrative password that are used to authenticate to the member's certificate authority (CA).
  - (Optional) Integrate the external CA by updating the member configuration
  - Create VPC endpoint for the network
  - Create a Peer Node
  - Set up a client
  - Enroll an Administrative User
  - Create a channel and join your peer node to the channel
  - Invite member
  - Manage network policies
- Disaster Recovery
  - A backup-and-restore DR solution is designed to achieve RPO within hours and RTO in 24 hours or less
  - A pilot light DR solution is designed to achieve RPO within minutes and RTO within hours.
  - A warm standby DR solution is designed to achieve RPO within seconds and RTO within minutes.
  - A multi-Region (multi-site) active-active DR solution is designed to achieve near-zero RTO and RPO. 
- Mounting EFS:
  - EFS file system, EC2, ECS cluster, and Fargate task must be in the same VPC
  - Allow inbound connection from port 2049 from the security group of Fargate task, allow outbound connection on port 2049 to EFS file system's security group.
